{"version":3,"sources":["books.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","delayBookAnimation","bookClassName","screenIsSmall","window","matchMedia","matches","screenIsMedium","screenIsLarge","screenIsXLarge","book","document","getElementsByClassName","bookIndex","Array","prototype","forEach","el","index","array","bookDelay","setAttribute","echo","init","offset","throttle","unload","./vendor/echo.js","2","root","factory","define","amd","this","poll","delay","useDebounce","callback","inView","element","view","offsetParent","isHidden","box","getBoundingClientRect","right","bottom","left","top","b","debounceOrThrottle","clearTimeout","setTimeout","render","opts","offsetAll","offsetVertical","offsetHorizontal","optionToInt","opt","fallback","parseInt","offsetTop","offsetBottom","offsetLeft","offsetRight","debounce","addEventListener","attachEvent","context","src","elem","nodes","querySelectorAll","innerHeight","documentElement","clientHeight","innerWidth","clientWidth","getAttribute","style","backgroundImage","removeAttribute","detach","removeEventListener","detachEvent"],"mappings":"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","file":"books.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n?n:e)}),l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[(function(require,module,exports){\nvar echo = require('./vendor/echo.js')\n\necho.echo.init({\n\toffset: 0,\n\tthrottle: 15,\n\tunload: false\n});\n\nfunction delayBookAnimation(bookClassName) {\n\tvar screenIsSmall = window.matchMedia('(max-width: 60rem)').matches;\n\tvar screenIsMedium = window.matchMedia('(min-width: 60rem) and (max-width: 75rem)').matches;\n\tvar screenIsLarge = window.matchMedia('(min-width: 75rem) and (max-width: 90rem)').matches;\n\tvar screenIsXLarge = window.matchMedia('(min-width: 90rem)').matches;\n\n\tvar bookBreakSmall = 2 + 1;\n\tvar bookBreakMedium = 3 + 1;\n\tvar bookBreakLarge = 4 + 1;\n\tvar bookBreakXLarge = 5 + 1;\n\n\tvar book = document.getElementsByClassName(bookClassName);\n\tvar bookIndex = 0;\n\n\tArray.prototype.forEach.call(book, (function(el, index, array) {\n\t\tbookIndex ++;\n\n\t\tif (screenIsSmall) {\n\t\t\tif (bookIndex == bookBreakSmall) {\n\t\t\t\tbookIndex = 1;\n\t\t\t}\n\t\t\tvar bookDelay = bookIndex + '00';\n\t\t\tel.setAttribute('data-aos-delay', bookDelay);\n\t\t}\n\t\telse if (screenIsMedium) {\n\t\t\tif (bookIndex == bookBreakMedium) {\n\t\t\t\tbookIndex = 1;\n\t\t\t}\n\t\t\tvar bookDelay = bookIndex + '00';\n\t\t\tel.setAttribute('data-aos-delay', bookDelay);\n\t\t}\n\t\telse if (screenIsLarge) {\n\t\t\tif (bookIndex == bookBreakLarge) {\n\t\t\t\tbookIndex = 1;\n\t\t\t}\n\t\t\tvar bookDelay = bookIndex + '00';\n\t\t\tel.setAttribute('data-aos-delay', bookDelay);\n\t\t}\n\t\telse if (screenIsXLarge) {\n\t\t\tif (bookIndex == bookBreakXLarge) {\n\t\t\t\tbookIndex = 1;\n\t\t\t}\n\t\t\tvar bookDelay = bookIndex + '00';\n\t\t\tel.setAttribute('data-aos-delay', bookDelay);\n\t\t}\n\t}));\n}\n\ndelayBookAnimation('iten--non-fiction')\ndelayBookAnimation('item--fiction')\n\n\n\n}),{\"./vendor/echo.js\":2}],2:[(function(require,module,exports){\n/*! echo-js v1.7.3 | (c) 2016 @toddmotto | https://github.com/toddmotto/echo */\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define((function() {\n      return factory(root);\n    }));\n  } else if (typeof exports === 'object') {\n    module.exports = factory;\n  } else {\n    root.echo = factory(root);\n  }\n})(this, (function (root) {\n\n  'use strict';\n\n  var echo = {};\n\n  var callback = function () {};\n\n  var offset, poll, delay, useDebounce, unload;\n\n  var isHidden = function (element) {\n    return (element.offsetParent === null);\n  };\n  \n  var inView = function (element, view) {\n    if (isHidden(element)) {\n      return false;\n    }\n\n    var box = element.getBoundingClientRect();\n    return (box.right >= view.l && box.bottom >= view.t && box.left <= view.r && box.top <= view.b);\n  };\n\n  var debounceOrThrottle = function () {\n    if(!useDebounce && !!poll) {\n      return;\n    }\n    clearTimeout(poll);\n    poll = setTimeout((function(){\n      echo.render();\n      poll = null;\n    }), delay);\n  };\n\n  echo.init = function (opts) {\n    opts = opts || {};\n    var offsetAll = opts.offset || 0;\n    var offsetVertical = opts.offsetVertical || offsetAll;\n    var offsetHorizontal = opts.offsetHorizontal || offsetAll;\n    var optionToInt = function (opt, fallback) {\n      return parseInt(opt || fallback, 10);\n    };\n    offset = {\n      t: optionToInt(opts.offsetTop, offsetVertical),\n      b: optionToInt(opts.offsetBottom, offsetVertical),\n      l: optionToInt(opts.offsetLeft, offsetHorizontal),\n      r: optionToInt(opts.offsetRight, offsetHorizontal)\n    };\n    delay = optionToInt(opts.throttle, 250);\n    useDebounce = opts.debounce !== false;\n    unload = !!opts.unload;\n    callback = opts.callback || callback;\n    echo.render();\n    if (document.addEventListener) {\n      root.addEventListener('scroll', debounceOrThrottle, false);\n      root.addEventListener('load', debounceOrThrottle, false);\n    } else {\n      root.attachEvent('onscroll', debounceOrThrottle);\n      root.attachEvent('onload', debounceOrThrottle);\n    }\n  };\n\n  echo.render = function (context) {\n    var nodes = (context || document).querySelectorAll('[data-echo], [data-echo-background]');\n    var length = nodes.length;\n    var src, elem;\n    var view = {\n      l: 0 - offset.l,\n      t: 0 - offset.t,\n      b: (root.innerHeight || document.documentElement.clientHeight) + offset.b,\n      r: (root.innerWidth || document.documentElement.clientWidth) + offset.r\n    };\n    for (var i = 0; i < length; i++) {\n      elem = nodes[i];\n      if (inView(elem, view)) {\n\n        if (unload) {\n          elem.setAttribute('data-echo-placeholder', elem.src);\n        }\n\n        if (elem.getAttribute('data-echo-background') !== null) {\n          elem.style.backgroundImage = 'url(' + elem.getAttribute('data-echo-background') + ')';\n        }\n        else if (elem.src !== (src = elem.getAttribute('data-echo'))) {\n          elem.src = src;\n        }\n\n        if (!unload) {\n          elem.removeAttribute('data-echo');\n          elem.removeAttribute('data-echo-background');\n        }\n\n        callback(elem, 'load');\n      }\n      else if (unload && !!(src = elem.getAttribute('data-echo-placeholder'))) {\n\n        if (elem.getAttribute('data-echo-background') !== null) {\n          elem.style.backgroundImage = 'url(' + src + ')';\n        }\n        else {\n          elem.src = src;\n        }\n\n        elem.removeAttribute('data-echo-placeholder');\n        callback(elem, 'unload');\n      }\n    }\n    if (!length) {\n      echo.detach();\n    }\n  };\n\n  echo.detach = function () {\n    if (document.removeEventListener) {\n      root.removeEventListener('scroll', debounceOrThrottle);\n    } else {\n      root.detachEvent('onscroll', debounceOrThrottle);\n    }\n    clearTimeout(poll);\n  };\n\n  return echo;\n\n}));\n\n}),{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNfYXNzZXRzL2pzL2Jvb2tzLmpzIiwic3JjX2Fzc2V0cy9qcy92ZW5kb3IvZWNoby5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgZWNobyA9IHJlcXVpcmUoJy4vdmVuZG9yL2VjaG8uanMnKVxuXG5lY2hvLmVjaG8uaW5pdCh7XG5cdG9mZnNldDogMCxcblx0dGhyb3R0bGU6IDE1LFxuXHR1bmxvYWQ6IGZhbHNlXG59KTtcblxuZnVuY3Rpb24gZGVsYXlCb29rQW5pbWF0aW9uKGJvb2tDbGFzc05hbWUpIHtcblx0dmFyIHNjcmVlbklzU21hbGwgPSB3aW5kb3cubWF0Y2hNZWRpYSgnKG1heC13aWR0aDogNjByZW0pJykubWF0Y2hlcztcblx0dmFyIHNjcmVlbklzTWVkaXVtID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtaW4td2lkdGg6IDYwcmVtKSBhbmQgKG1heC13aWR0aDogNzVyZW0pJykubWF0Y2hlcztcblx0dmFyIHNjcmVlbklzTGFyZ2UgPSB3aW5kb3cubWF0Y2hNZWRpYSgnKG1pbi13aWR0aDogNzVyZW0pIGFuZCAobWF4LXdpZHRoOiA5MHJlbSknKS5tYXRjaGVzO1xuXHR2YXIgc2NyZWVuSXNYTGFyZ2UgPSB3aW5kb3cubWF0Y2hNZWRpYSgnKG1pbi13aWR0aDogOTByZW0pJykubWF0Y2hlcztcblxuXHR2YXIgYm9va0JyZWFrU21hbGwgPSAyICsgMTtcblx0dmFyIGJvb2tCcmVha01lZGl1bSA9IDMgKyAxO1xuXHR2YXIgYm9va0JyZWFrTGFyZ2UgPSA0ICsgMTtcblx0dmFyIGJvb2tCcmVha1hMYXJnZSA9IDUgKyAxO1xuXG5cdHZhciBib29rID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShib29rQ2xhc3NOYW1lKTtcblx0dmFyIGJvb2tJbmRleCA9IDA7XG5cblx0QXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChib29rLCBmdW5jdGlvbihlbCwgaW5kZXgsIGFycmF5KSB7XG5cdFx0Ym9va0luZGV4ICsrO1xuXG5cdFx0aWYgKHNjcmVlbklzU21hbGwpIHtcblx0XHRcdGlmIChib29rSW5kZXggPT0gYm9va0JyZWFrU21hbGwpIHtcblx0XHRcdFx0Ym9va0luZGV4ID0gMTtcblx0XHRcdH1cblx0XHRcdHZhciBib29rRGVsYXkgPSBib29rSW5kZXggKyAnMDAnO1xuXHRcdFx0ZWwuc2V0QXR0cmlidXRlKCdkYXRhLWFvcy1kZWxheScsIGJvb2tEZWxheSk7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHNjcmVlbklzTWVkaXVtKSB7XG5cdFx0XHRpZiAoYm9va0luZGV4ID09IGJvb2tCcmVha01lZGl1bSkge1xuXHRcdFx0XHRib29rSW5kZXggPSAxO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGJvb2tEZWxheSA9IGJvb2tJbmRleCArICcwMCc7XG5cdFx0XHRlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYW9zLWRlbGF5JywgYm9va0RlbGF5KTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAoc2NyZWVuSXNMYXJnZSkge1xuXHRcdFx0aWYgKGJvb2tJbmRleCA9PSBib29rQnJlYWtMYXJnZSkge1xuXHRcdFx0XHRib29rSW5kZXggPSAxO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGJvb2tEZWxheSA9IGJvb2tJbmRleCArICcwMCc7XG5cdFx0XHRlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYW9zLWRlbGF5JywgYm9va0RlbGF5KTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAoc2NyZWVuSXNYTGFyZ2UpIHtcblx0XHRcdGlmIChib29rSW5kZXggPT0gYm9va0JyZWFrWExhcmdlKSB7XG5cdFx0XHRcdGJvb2tJbmRleCA9IDE7XG5cdFx0XHR9XG5cdFx0XHR2YXIgYm9va0RlbGF5ID0gYm9va0luZGV4ICsgJzAwJztcblx0XHRcdGVsLnNldEF0dHJpYnV0ZSgnZGF0YS1hb3MtZGVsYXknLCBib29rRGVsYXkpO1xuXHRcdH1cblx0fSk7XG59XG5cbmRlbGF5Qm9va0FuaW1hdGlvbignaXRlbi0tbm9uLWZpY3Rpb24nKVxuZGVsYXlCb29rQW5pbWF0aW9uKCdpdGVtLS1maWN0aW9uJylcblxuXG4iLCIvKiEgZWNoby1qcyB2MS43LjMgfCAoYykgMjAxNiBAdG9kZG1vdHRvIHwgaHR0cHM6Ly9naXRodWIuY29tL3RvZGRtb3R0by9lY2hvICovXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBmYWN0b3J5KHJvb3QpO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeTtcbiAgfSBlbHNlIHtcbiAgICByb290LmVjaG8gPSBmYWN0b3J5KHJvb3QpO1xuICB9XG59KSh0aGlzLCBmdW5jdGlvbiAocm9vdCkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgZWNobyA9IHt9O1xuXG4gIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHt9O1xuXG4gIHZhciBvZmZzZXQsIHBvbGwsIGRlbGF5LCB1c2VEZWJvdW5jZSwgdW5sb2FkO1xuXG4gIHZhciBpc0hpZGRlbiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgcmV0dXJuIChlbGVtZW50Lm9mZnNldFBhcmVudCA9PT0gbnVsbCk7XG4gIH07XG4gIFxuICB2YXIgaW5WaWV3ID0gZnVuY3Rpb24gKGVsZW1lbnQsIHZpZXcpIHtcbiAgICBpZiAoaXNIaWRkZW4oZWxlbWVudCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgYm94ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICByZXR1cm4gKGJveC5yaWdodCA+PSB2aWV3LmwgJiYgYm94LmJvdHRvbSA+PSB2aWV3LnQgJiYgYm94LmxlZnQgPD0gdmlldy5yICYmIGJveC50b3AgPD0gdmlldy5iKTtcbiAgfTtcblxuICB2YXIgZGVib3VuY2VPclRocm90dGxlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmKCF1c2VEZWJvdW5jZSAmJiAhIXBvbGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY2xlYXJUaW1lb3V0KHBvbGwpO1xuICAgIHBvbGwgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICBlY2hvLnJlbmRlcigpO1xuICAgICAgcG9sbCA9IG51bGw7XG4gICAgfSwgZGVsYXkpO1xuICB9O1xuXG4gIGVjaG8uaW5pdCA9IGZ1bmN0aW9uIChvcHRzKSB7XG4gICAgb3B0cyA9IG9wdHMgfHwge307XG4gICAgdmFyIG9mZnNldEFsbCA9IG9wdHMub2Zmc2V0IHx8IDA7XG4gICAgdmFyIG9mZnNldFZlcnRpY2FsID0gb3B0cy5vZmZzZXRWZXJ0aWNhbCB8fCBvZmZzZXRBbGw7XG4gICAgdmFyIG9mZnNldEhvcml6b250YWwgPSBvcHRzLm9mZnNldEhvcml6b250YWwgfHwgb2Zmc2V0QWxsO1xuICAgIHZhciBvcHRpb25Ub0ludCA9IGZ1bmN0aW9uIChvcHQsIGZhbGxiYWNrKSB7XG4gICAgICByZXR1cm4gcGFyc2VJbnQob3B0IHx8IGZhbGxiYWNrLCAxMCk7XG4gICAgfTtcbiAgICBvZmZzZXQgPSB7XG4gICAgICB0OiBvcHRpb25Ub0ludChvcHRzLm9mZnNldFRvcCwgb2Zmc2V0VmVydGljYWwpLFxuICAgICAgYjogb3B0aW9uVG9JbnQob3B0cy5vZmZzZXRCb3R0b20sIG9mZnNldFZlcnRpY2FsKSxcbiAgICAgIGw6IG9wdGlvblRvSW50KG9wdHMub2Zmc2V0TGVmdCwgb2Zmc2V0SG9yaXpvbnRhbCksXG4gICAgICByOiBvcHRpb25Ub0ludChvcHRzLm9mZnNldFJpZ2h0LCBvZmZzZXRIb3Jpem9udGFsKVxuICAgIH07XG4gICAgZGVsYXkgPSBvcHRpb25Ub0ludChvcHRzLnRocm90dGxlLCAyNTApO1xuICAgIHVzZURlYm91bmNlID0gb3B0cy5kZWJvdW5jZSAhPT0gZmFsc2U7XG4gICAgdW5sb2FkID0gISFvcHRzLnVubG9hZDtcbiAgICBjYWxsYmFjayA9IG9wdHMuY2FsbGJhY2sgfHwgY2FsbGJhY2s7XG4gICAgZWNoby5yZW5kZXIoKTtcbiAgICBpZiAoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgcm9vdC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBkZWJvdW5jZU9yVGhyb3R0bGUsIGZhbHNlKTtcbiAgICAgIHJvb3QuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGRlYm91bmNlT3JUaHJvdHRsZSwgZmFsc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICByb290LmF0dGFjaEV2ZW50KCdvbnNjcm9sbCcsIGRlYm91bmNlT3JUaHJvdHRsZSk7XG4gICAgICByb290LmF0dGFjaEV2ZW50KCdvbmxvYWQnLCBkZWJvdW5jZU9yVGhyb3R0bGUpO1xuICAgIH1cbiAgfTtcblxuICBlY2hvLnJlbmRlciA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgdmFyIG5vZGVzID0gKGNvbnRleHQgfHwgZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWVjaG9dLCBbZGF0YS1lY2hvLWJhY2tncm91bmRdJyk7XG4gICAgdmFyIGxlbmd0aCA9IG5vZGVzLmxlbmd0aDtcbiAgICB2YXIgc3JjLCBlbGVtO1xuICAgIHZhciB2aWV3ID0ge1xuICAgICAgbDogMCAtIG9mZnNldC5sLFxuICAgICAgdDogMCAtIG9mZnNldC50LFxuICAgICAgYjogKHJvb3QuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCkgKyBvZmZzZXQuYixcbiAgICAgIHI6IChyb290LmlubmVyV2lkdGggfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKSArIG9mZnNldC5yXG4gICAgfTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBlbGVtID0gbm9kZXNbaV07XG4gICAgICBpZiAoaW5WaWV3KGVsZW0sIHZpZXcpKSB7XG5cbiAgICAgICAgaWYgKHVubG9hZCkge1xuICAgICAgICAgIGVsZW0uc2V0QXR0cmlidXRlKCdkYXRhLWVjaG8tcGxhY2Vob2xkZXInLCBlbGVtLnNyYyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZWxlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZWNoby1iYWNrZ3JvdW5kJykgIT09IG51bGwpIHtcbiAgICAgICAgICBlbGVtLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoJyArIGVsZW0uZ2V0QXR0cmlidXRlKCdkYXRhLWVjaG8tYmFja2dyb3VuZCcpICsgJyknO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGVsZW0uc3JjICE9PSAoc3JjID0gZWxlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZWNobycpKSkge1xuICAgICAgICAgIGVsZW0uc3JjID0gc3JjO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF1bmxvYWQpIHtcbiAgICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1lY2hvJyk7XG4gICAgICAgICAgZWxlbS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZWNoby1iYWNrZ3JvdW5kJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjYWxsYmFjayhlbGVtLCAnbG9hZCcpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAodW5sb2FkICYmICEhKHNyYyA9IGVsZW0uZ2V0QXR0cmlidXRlKCdkYXRhLWVjaG8tcGxhY2Vob2xkZXInKSkpIHtcblxuICAgICAgICBpZiAoZWxlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZWNoby1iYWNrZ3JvdW5kJykgIT09IG51bGwpIHtcbiAgICAgICAgICBlbGVtLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoJyArIHNyYyArICcpJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBlbGVtLnNyYyA9IHNyYztcbiAgICAgICAgfVxuXG4gICAgICAgIGVsZW0ucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWVjaG8tcGxhY2Vob2xkZXInKTtcbiAgICAgICAgY2FsbGJhY2soZWxlbSwgJ3VubG9hZCcpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWxlbmd0aCkge1xuICAgICAgZWNoby5kZXRhY2goKTtcbiAgICB9XG4gIH07XG5cbiAgZWNoby5kZXRhY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgIHJvb3QucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZGVib3VuY2VPclRocm90dGxlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcm9vdC5kZXRhY2hFdmVudCgnb25zY3JvbGwnLCBkZWJvdW5jZU9yVGhyb3R0bGUpO1xuICAgIH1cbiAgICBjbGVhclRpbWVvdXQocG9sbCk7XG4gIH07XG5cbiAgcmV0dXJuIGVjaG87XG5cbn0pO1xuIl19\n"]}